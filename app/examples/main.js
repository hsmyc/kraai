function Y(B,T){if(B.length!==T.length)return!1;for(let E=0;E<B.length;E++)if(B[E]!==T[E])return!1;return!0}function G(){if(!Q)Q=!0,Promise.resolve().then(z)}function z(){Q=!1;const B=new Set;while(W.size>0){const T=new Set(W);W.clear();for(let E of T){if(B.has(E))continue;if("recompute"in E){B.add(E),E.recompute();const I=E.get(),k=E;for(let L of k.subscribers)L(I)}}for(let E of T){if(B.has(E))continue;if(!("recompute"in E)){B.add(E);const I=E,k=E.get();for(let L of I.subscribers)L(k)}}for(let E of B){const I=E;for(let k of I.dependents)if(!B.has(k))W.add(k)}}}function R(B,T,E){B.clear();for(let I of T)I.removeDependency(E);T.clear()}function U(B,T){B.add(T)}function Z(B,T){B.delete(T)}function K(B){let T=structuredClone(B);const E=new Set,I=new Set,k={get(){if(j)j.addDependency(k),U(I,j);return T},set(L){if(T!==L)T=structuredClone(L),W.add(k),G()},subscribe(L){return E.add(L),L(T),()=>{if(E.delete(L),E.size===0&&I.size===0)R(E,I,k)}},subscribers:E,dependents:I,addDependency(L){I.add(L)},removeDependency(L){I.delete(L)}};return[k.get,k.set,k.subscribe]}function f(B){let T;const E=new Set,I=new Set,k=new Set;let L=[];const N={get(){if(j&&j!==N)j.addDependency(N),U(k,j);return T},set(J){throw new Error("Cannot set value of a computed state")},subscribe(J){return E.add(J),J(T),()=>{if(E.delete(J),E.size===0&&I.size===0&&k.size===0)R(E,k,N)}},recompute(){for(let A of I)Z(A.dependents,N);I.clear();const J=j;j=N;const $=B(),H=Array.from(I);if(!Y(L,H))T=structuredClone($),L=H;if(j=J,T!==$)T=structuredClone($),W.add(N),G()},addDependency(J){I.add(J)},removeDependency(J){I.delete(J)},subscribers:E,dependents:k};return N.recompute(),[N.get,N.subscribe]}function m(B,T){let E=structuredClone(T);const I=new Set,k=new Set,L=new Set;let N=[],J=null;const $={get(){if(j&&j!==$)j.addDependency($),U(L,j);return E},set(H){J={...J,...H},E={...structuredClone(E),...J},W.add($),G()},subscribe(H){return I.add(H),H(E),()=>{if(I.delete(H),I.size===0&&k.size===0&&L.size===0)R(I,L,$)}},recompute(){for(let q of k)Z(q.dependents,$);k.clear();const H=j;j=$;const A=B(),X=Array.from(k);if(!Y(N,X))N=X;if(j=H,J)E={...structuredClone(A),...J};else E=structuredClone(A);W.add($),G()},addDependency(H){k.add(H)},removeDependency(H){k.delete(H)},subscribers:I,dependents:L};return $.recompute(),[$.get,$.set,$.subscribe]}var j=null,W=new Set,Q=!1;function i(){O(x()+1)}function r(){O(x()-1)}function u(){_({name:{first:"Jane",last:"Doe"}})}function t(){h(y()+1)}function n(){fetch("https://randomuser.me/api/").then((B)=>B.json()).then((B)=>{console.log(B.results[0]),V(B.results[0])})}function d(B){P.innerText=B}function p(B){c.innerText=B}function s(B){M.style.border="1px solid black",M.style.maxWidth="200px",M.style.color="red",M.innerText=`${B.no} ${B.name.first} ${B.name.last}`}function e(B){b.innerText=B}function EE(B){a.innerText=JSON.stringify(B)}var[x,O,o]=K(0),[TE,F]=f(()=>x()*2),[y,h,w]=K(0),[kE,_,D]=m(()=>({no:x(),name:{first:"John",last:"Doe"}}),{no:x(),name:{first:"John",last:"Doe"}}),[LE,V,C]=K({}),P=document.getElementById("count"),c=document.getElementById("scount"),M=document.getElementById("name2"),g=document.getElementById("increment"),v=document.getElementById("decrement"),S=document.getElementById("name"),b=document.getElementById("timer"),l=document.getElementById("data"),a=document.getElementById("data2");g?.addEventListener("click",i);S?.addEventListener("click",()=>{u()});v?.addEventListener("click",r);l?.addEventListener("click",n);setInterval(t,1000);o(d);F(p);D(s);w(e);C(EE);
