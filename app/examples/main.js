function G(B,k){if(B.length!==k.length)return!1;for(let E=0;E<B.length;E++)if(B[E]!==k[E])return!1;return!0}function R(){if(!Y)Y=!0,Promise.resolve().then(f)}function f(){Y=!1;const B=new Set;while(K.size>0){const k=new Set(K);K.clear();for(let E of k){if(B.has(E))continue;if("recompute"in E){B.add(E),E.recompute();const I=E.get(),L=E;for(let J of L.subscribers)J(I)}}for(let E of k){if(B.has(E))continue;if(!("recompute"in E)){B.add(E);const I=E,L=E.get();for(let J of I.subscribers)J(L)}}for(let E of B){const I=E;for(let L of I.dependents)if(!B.has(L))K.add(L)}}}function Z(B,k,E){B.clear();for(let I of k)I.removeDependency(E);k.clear()}function x(B,k){B.add(k)}function q(B,k){B.delete(k)}function U(B){let k=structuredClone(B);const E=new Set,I=new Set,L={get(){if(j)j.addDependency(L),x(I,j);return k},set(J){if(k!==J)k=structuredClone(J),K.add(L),R()},subscribe(J){return E.add(J),J(k),()=>{if(E.delete(J),E.size===0&&I.size===0)Z(E,I,L)}},subscribers:E,dependents:I,addDependency(J){I.add(J)},removeDependency(J){I.delete(J)}};return[L.get,L.set,L.subscribe]}function O(B){let k;const E=new Set,I=new Set,L=new Set;let J=[];const H={get(){if(j&&j!==H)j.addDependency(H),x(L,j);return k},set($){throw new Error("Cannot set value of a computed state")},subscribe($){return E.add($),$(k),()=>{if(E.delete($),E.size===0&&I.size===0&&L.size===0)Z(E,L,H)}},recompute(){for(let Q of I)q(Q.dependents,H);I.clear();const $=j;j=H;const N=B(),W=Array.from(I);if(!G(J,W))k=structuredClone(N),J=W;if(j=$,k!==N)k=structuredClone(N),K.add(H),R()},addDependency($){I.add($)},removeDependency($){I.delete($)},subscribers:E,dependents:L};return H.recompute(),[H.get,H.subscribe]}function T(B,k){let E=structuredClone(k);const I=new Set,L=new Set,J=new Set;let H=[],$=null;const N={get(){if(j&&j!==N)j.addDependency(N),x(J,j);return E},set(W){$={...$,...W},E={...structuredClone(E),...$},K.add(N),R()},subscribe(W){return I.add(W),W(E),()=>{if(I.delete(W),I.size===0&&L.size===0&&J.size===0)Z(I,J,N)}},recompute(){for(let F of L)q(F.dependents,N);L.clear();const W=j;j=N;const Q=B(),z=Array.from(L);if(!G(H,z))H=z;if(j=W,$)E={...structuredClone(Q),...$};else E=structuredClone(Q);K.add(N),R()},addDependency(W){L.add(W)},removeDependency(W){L.delete(W)},subscribers:I,dependents:J};return N.recompute(),[N.get,N.set,N.subscribe]}var j=null,K=new Set,Y=!1;function r(){A(M()+1)}function u(){A(M()-1)}function a(){V({name:{first:"Jane",last:"Doe"}})}function d(){y(_()+1)}function n(){fetch("https://randomuser.me/api/").then((B)=>B.json()).then((B)=>{console.log(B.results[0]),P(B.results[0])})}function p(B){o.innerText=B}function s(B){v.innerText=B}function t(B){X.style.border="1px solid black",X.style.maxWidth="200px",X.style.color="red",X.innerText=`${B.no} ${B.name.first} ${B.name.last}`}function e(B){c.innerText=B}function EE(B){i.innerText=JSON.stringify(B)}var[M,A,m]=U(0),[kE,w]=O(()=>M()*2),[_,y,D]=U(0),[LE,V,C]=T(()=>({no:M(),name:{first:"John",last:"Doe"}}),{no:M(),name:{first:"John",last:"Doe"}}),[JE,P,h]=U({}),o=document.getElementById("count"),v=document.getElementById("scount"),X=document.getElementById("name2"),g=document.getElementById("increment"),S=document.getElementById("decrement"),b=document.getElementById("name"),c=document.getElementById("timer"),l=document.getElementById("data"),i=document.getElementById("data2");g?.addEventListener("click",r);b?.addEventListener("click",()=>{a()});S?.addEventListener("click",u);l?.addEventListener("click",n);setInterval(d,1000);m(p);w(s);C(t);D(e);h(EE);
